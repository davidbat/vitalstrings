82.0.xxx.xxx to 82.31.xxx.xxx.
213.104.xxx.xxx to 213.107.xxx.xxx.
It is quite normal for one UBR to have more than one IP address range assigned for customers, and these ranges might be quite different in their leading digits. When you are allocated a fresh IP address by DHCP, it is as likely to come from one range as another: a change of IP address range is not a cause for concern.
An IP address of the form 169.254.xxx.xxx is an error condition .
Finding the Default Gateway address
The Default Gateway (or Router) is your link to the internet: your PC will send IP packets to, and receive IP packets from, the Default Gateway (except when the packet is to or from another IP address on the same sub-net as yourself, in which case it goes direct). On a cable network, the Default Gateway address is physically part of the UBR (head-end).
It is very common for the Default Gateway address to end in .1 or .254, with the first three parts being the same as the public WAN IP address for the connection.
If your PC/Mac is connected directly to the cable modem, you can discover the Default Gateway address of your connection as follows:
Win9x/ME: click Start, Run, enter the command winipcfg. Use the pull-down item to select the network interface for the cable modem (rather than any PPP dial-up). Look for the line Default Gateway.
Windows (any version except Win95): open a command window, type the command ipconfig. Look for the output section related to the network interface for the cable modem:
2 Ethernet adapter :          IP Address. . . . . . . . . : 213.107.117.246         Subnet Mask . . . . . . . . : 255.255.255.0         Default Gateway . . . . . . : 213.107.117.254
Windows XP: Open Control Panel Network Connections, right-click the network interface for the cable modem and select Properties, click tab Support. Look for the line Default Gateway.
Apple Mac 8.x/9.x: Pull down the Apple menu, select Control Panels. Open the control panel TCP/IP. Look for the line Router address.
Apple Mac OS X: any of the following:
Pull down the Apple menu, select System Properties, click Network. In the pull-down Show: select the network interface in use. Click tab TCP/IP and look for the line Router.
Open a Terminal window, type the command ipconfig getoption en0 router (where en0 is the name of the interface in use).
If your PC is on a home LAN connected via a NAT router to the cable modem, use the configuration pages or program for the NAT router to discover the Gateway address. For instance, for the Linksys routers, send your web browser to http://192.168.1.1/ , click the tab Status, and look for the line Default Gateway. See example above .
Finding the cable modem's address
Most DOCSIS cable modems have two IP addresses:
a customer-side IP address used on the ethernet/USB socket to which the user connects;
an ISP-side IP address used on the CATV socket to which the ISP's network connects.
The customer-side IP address of a DOCSIS cable modem is normally 192.168.100.1. For 3Com Tailfins with early firmware versions it was 149.112.50.65. Firmware can be automatically updated by your cable operator down the cable, so by the time you read this, most Tailfins will have been updated to use the standard address. The 3Com CMX does not have a customer-side IP address.
The IP address 192.168.100.1 will be present even if no web diagnostics are offered on that address.
The cable modem IP address 192.168.100.1 is not in the same sub-net as the user's PC. So, when trying to send to 192.168.100.1, the user PC's IP stack will normally route the packet to the Default Gateway address at the UBR. Since no routes exist to the private address 192.168.100.1 (and there are multiple instances of this IP address on any one CATV segment), the UBR drops the packet. This would mean that in theory the PC could never talk to the cable modem. However, the Surfboard, the 3Com Tailfin, and the ntl:home 100/120 are capable of sniffing the passing traffic through the transparent bridge to intercept any packets addressed to themselves. This only works when the bridge is open, so the cable modem diagnostics cannot be read when the cable modem is booting up or failing to remain in contact with the UBR.
For cable modems other than the Surfboard, Tailfin and ntl:home 100/120, and for the Surfboard/Tailfin when their bridge is closed, the only way to communicate with them is:
reconfigure the PC by disabling DHCP and manually assigning an IP address 192.168.100.xx, where xx is in the range 2-254, sub-net mask 255.255.255.0, and Default Gateway 192.168.100.1. This has the disadvantage of being incompatible with normal in-service usage; or
add a secondary IP address to the PC's network interface, leaving the primary IP address to be allocated by DHCP. The secondary IP address should be 192.168.100.xx where xx is in the range 2-254, with sub-net mask 255.255.255.0. The procedure for adding secondary IP addresses depends on operating system: for Windows 9x/ME it can be done only by editing the Registry, see http://support.microsoft.com/support/kb/articles/Q156/7/72.asp .
Note that, with the Surfboard and ntl:home 100/120, when the cable modem is not online to the cable operator's network, it runs an internal DHCP server which automatically gives the PC an IP configuration on the 192.168.100.xx sub-net to enable the PC to communicate with the cable modem on 192.168.100.1.
Finding the UBR address
The UBR in fact has more than one IP address. One of the public IP addresses that it has is the WAN Default Gateway address that is allocated to your PC by your cable ISP. You should use this Default Gateway address when you wish to request a service (e.g. time synchronisation ) from the UBR.
The other address for the UBR will usually be a private IP address, which will be the apparent source of IP packets sent from the UBR itself to your PC. You should use the private IP address for the UBR, for instance, when configuring firewalls to permit the UBR to send to your PC, or when using the -ubrip option of the DocsDiag program. To find the private IP address of the interface of the UBR to which your cable modem is connected, perform a traceroute to anywhere. The private IP address of the UBR will normally be returned in hop 1 of the traceroute results:
C:\WINDOWS>tracert www.bbc.co.uk Tracing route to www.bbc.net.uk [212.58.224.35] over a maximum of 30 hops:    1    67 ms    23 ms    22 ms 172.16.231.254 2    17 ms    25 ms    55 ms  cam-cam1-a-fa00.inet.ntl.com [62.253.129.1]   3    22 ms    17 ms    15 ms  cam-core-a-pos200.inet.ntl.com [62.253.128.133]   4    27 ms    28 ms    33 ms  gfd-bb-a-atm100-228.inet.ntl.com [213.105.172.38]   5    61 ms    31 ms    28 ms  lng-bb-b-so-700-0.inet.ntl.com [213.105.172.142]   6    40 ms    44 ms    61 ms  linx-ic-2-so-230-0.inet.ntl.com [62.253.184.174]   7    46 ms    47 ms    48 ms  rt-linx-a.thdo.bbc.co.uk [195.66.224.103]   8    28 ms    32 ms    30 ms  www.bbc.net.uk [212.58.224.35]  Trace complete.
If you have a home LAN with a NAT router, then in some cases, the NAT router inserts itself as a new first hop, in which case the IP address of the UBR will be returned in hop 2:
C:\WINDOWS>tracert www.bbc.co.uk Tracing route to www.bbc.net.uk [212.58.224.35] over a maximum of 30 hops:    1 <10 ms <10 ms <10 ms  192.168.123.254   2    67 ms    23 ms    22 ms 172.16.231.254 3    17 ms    25 ms    55 ms  cam-cam1-a-fa00.inet.ntl.com [62.253.129.1]   4    22 ms    17 ms    15 ms  cam-core-a-pos200.inet.ntl.com [62.253.128.133]   5    27 ms    28 ms    33 ms  gfd-bb-a-atm100-228.inet.ntl.com [213.105.172.38]   6    61 ms    31 ms    28 ms  lng-bb-b-so-700-0.inet.ntl.com [213.105.172.142]   7    40 ms    44 ms    61 ms  linx-ic-2-so-230-0.inet.ntl.com [62.253.184.174]   8    46 ms    47 ms    48 ms  rt-linx-a.thdo.bbc.co.uk [195.66.224.103]   9    28 ms    32 ms    30 ms  www.bbc.net.uk [212.58.224.35]  Trace complete.
The Linksys NAT routers are an example of a router which does not insert an extra hop. The SMC Barricades are an example of a router which does insert an extra hop. The documentation or setup configuration of the home LAN router will normally tell you which IP address range it uses, so that it can be recognised in hop 1 above. Any 192.168.xxx.xxx address in hop 1 is more likely to be a home router than the UBR. But some home routers (e.g. Apple Airport) use the 10.xxx.xxx.xxx IP range, which can be confused with a UBR in the same range. When in doubt, disconnect the router, connect the PC directly to the cable modem, and try the traceroute again.
The UBR's private IP address is usually one of the following:
in the range 10.xxx.xxx.zzz (where zzz is 1 or 254)
in the range 172.yy.xxx.zzz (where yy is in the range 16-31, zzz is 1 or 254).
For original NTL franchises, the UBR will have a private IP address of the form 172.xx.xxx.254 or 10.xxx.xxx.254; for ex-C&W digital set-top-boxes, it will be of the form 10.xxx.xxx.1. For Blueyonder, the UBR will have an address of the form 10.xxx.xxx.1.
Why the UBR address is not always the same as the Default Gateway
Every IP sub-net needs a Default Gateway defined. All IP packets destined for hosts off the sub-net will be sent to the gateway for routing onwards. If your IP address is aaa.bbb.ccc.ddd, then the sub-net usually consists of all IP addresses of the form aaa.bbb.ccc.xxx, where xxx is any number in the range 1 to 254, and the gateway address could be aaa.bbb.ccc.1 or aaa.bbb.ccc.254. On a cable system, the gateway will physically be the UBR itself. On a normal ethernet, one would expect that packets from the gateway to you would show their source to be the gateway address. But on a cable system, this is not always the case. A single cable distribution system can host more than 253 customers, and so requires more than one customer sub-net active on the cable. A single UBR interface therefore functions as a gateway for more than one customer sub-net, each of which might be in different IP address ranges. So this single UBR interface is labelled with more than one IP address. Each of the customer sub-net public gateway IP addresses are treated as secondary IP addresses for the UBR interface, which is given a primary IP address in the private range of 10.xxx.xxx.1 or 172.xx.xxx.254. [This also enables the UBR to serve as the sub-net gateway for the CATV side of all the cable modems, which also have private 10.xxx.xxx.xxx or 172.xx.xxx.xxx addresses]. The upshot is that when the UBR originates a packet to an end-user (such as responding to a traceroute probe), the packet shows a source address of 10.xxx.xxx.1 or 172.xx.xxx.254, which does not appear to be an address on the end-user's sub-net, although physically it is. This private UBR address will have the same MAC address as the customer sub-net Default Gateway addresses have, because all these addresses are on the same physical UBR interface.
If you traceroute to the gateway, the public gateway IP address will reply.
If you traceroute through the gateway, the UBR's private IP address will reply.
Finding the DNS server address(es)
You can discover your assigned DNS addresses as follows:
In Win9x/ME, click Start, select Run, type in winipcfg, select the correct interface for the cable modem connection (not PPP dial-up) and click the More info button.
In Windows (all versions except Win95), open a command prompt window (you might need to make it longer by typing the command mode con,lines=50) and type the command ipconfig /all (in Windows 2000, the DNS Servers are listed in the adapter section, not at the top):
Windows 98 IP Configuration      Host Name . . . . . . . . . : RDHW-B.ntlworld.com     DNS Servers . . . . . . . . : 194.168.4.100 : 194.168.8.100 Node Type . . . . . . . . . : Broadcast     NetBIOS Scope ID. . . . . . :      IP Routing Enabled. . . . . : No     WINS Proxy Enabled. . . . . : No     NetBIOS Resolution Uses DNS : No  2 Ethernet adapter :      Description . . . . . . . . : Intel DC21041 PCI Ethernet Adapter     Physical Address. . . . . . : 00-60-1D-F6-7E-5C     DHCP Enabled. . . . . . . . : Yes     IP Address. . . . . . . . . : 213.107.117.246     Subnet Mask . . . . . . . . : 255.255.255.0     Default Gateway . . . . . . : 213.107.117.254     DHCP Server . . . . . . . . : 62.253.128.3     Primary WINS Server . . . . :      Secondary WINS Server . . . :      Lease Obtained. . . . . . . : 07 26 01 21:22:01     Lease Expires . . . . . . . :
Windows XP: Open Control Panel Network Connections, right-click the network interface for the cable modem and select Properties, click tab Support, click button Details. Look for the line DNS Servers.
In Apple Mac OS 8.x/9.x, pull down the Apple menu, click Control Panels, select TCP/IP. Look for the item Name Server addr. [If necessary, pull down the Edit menu, select User Mode, and check Basic]. Usually only the primary DNS server will be shown.
Apple Mac OS X: open a Terminal window, type the command ipconfig getpacket en0 (where en0 is the interface in use) and look for the line domain_name_server.
Finding the DHCP server address(es)
You can discover the address of the DHCP server from which your PC/Mac obtains IP address leases by:
In Windows, proceed as in Finding the DNS server address(es) above, reading the DHCP server address instead of the DNS server addresses.
Windows XP: Open Control Panel Network Connections, right-click the network interface for the cable modem and select Properties, click tab Support, click button Details. Look for the line DHCP Server.
Apple Mac OS 8.x/9.x: use the DHCP Lease tool of IPNetMonitor .
Apple Mac OS X: open a Terminal window, type the command ipconfig getoption en0 server_identifier (where en0 is the interface in use).
If the PC/Mac is on a home LAN behind a NAT router, then the DHCP server address obtained above might be the LAN address of the NAT router itself, providing a local DHCP service. If you want to discover the WAN DHCP server address of your ISP when your PC/Mac is on a home LAN:
Inspect the configuration of your NAT router (but the Linksys does not give this information);
With a Surfboard or Tailfin cable modem, the DHCP server address can be discovered from the cable modem's internal diagnostic web pages: the Addresses page of the Surfboard, or the Operation Configuration page of the 3Com Tailfin (not possible with CMX or TeraJet, unless you use the DocsDiag program with the -vv option).
With NTL stand-alone cable modems, there was originally just one DHCP server per region, but there will be a steady conversion to having two DHCP servers per region, starting in 2002. Each will act as a backup to the other. If you are writing firewall rules, you need to trust both DHCP servers. You can find the address of one of them by the procedures above. To find the address of the other:
Take the known DHCP server IP address as found above, and look up its DNS name: the result should look something like dhcpN-XXXX.server.ntli.net where:
XXXX is a region code of 3 or 4 letters;
N is either 1 or 2.
In that DNS name, alter the N field to its other possible value, then look up the IP address for that name. This will yield the IP address of the other DHCP server. If the lookup fails, there isn't a second DHCP server for your region.
With NTL digital TV STBs, there are two DHCP servers per region, each acting as a backup to the other. Their IP addresses will be of the form 10.0.xxx.70 and 10.0.xxx.71. The methods above will tell you the active one for your PC, enabling you to discover the value of xxx. If you are writing firewall rules, you need to also add the other one of the pair.
Blueyonder users have two DHCP servers, each acting as a backup to the other. They might be the same as your assigned DNS server addresses, but can be different. If you are writing firewall rules, you need to trust both DHCP servers. To determine the other address:
take the known DHCP server IP address as found above, and look up its DNS name: the result should look something like pXXsNNNo.blueyonder.co.uk where:
XX is one of the two-letter codes listed in Decoding your DNS name.
NNN is either 001 or 002.
In that DNS name, alter the NNN field to its other possible value, then look up the IP address for that name. This will yield the IP address of the other DHCP server.
Finding the address of the transparent web proxy cache
