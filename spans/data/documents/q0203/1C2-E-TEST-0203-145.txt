October 10, 2010
Find out which process is preventing emptying the trash on your Mac
I like tidying up my Mac every now and then and that includes manually emptying the Trash folder. I know that the trash gets automatically emptied, but it feels good to do it manually sometimes, especially if there are some really big files in it.
Every once in a while when I empty the trash, I get a message telling me that some file(s) in the trash can’t be permanently deleted because it’s being accessed by an application. Unfortunately, the message doesn’t say which application that is. If that were the case I could simply close that application and then empty the trash again. Without that information, all I can really do is reboot or simply ignore the issue.
Since I don’t like issues like this lingering around in the back of my mind and I like to get to the core of things, I did a bit of research on how to find out which application is accessing a specific file. Turns out it’s actually quite easy. It involves a Terminal command, but don’t worry, it’s not a big deal.
Let’s use the example of a file that’s “stuck” in the Trash folder. The command I’m about to show you works with any file, but to keep things simple I’m going to show you how to “unstick” a file that’s in the trash.
Open Terminal. It’s in the Utilities folder in the Applications folder. You can also type “term” into Spotlight, which should list it at the top of the results.
By default you should start out in your Home folder when Terminal launches. To see if that’s the case, look at the beginning of the line in which the prompt is blinking. It usually begins with the name of your Mac, followed by a colon and the name of the folder you’re in. If there’s a tilde (~) there, you’re in your Home folder. If it says anything else, simply type in ‘cd’ (without the quotes) and hit Enter. Now it should show a tilde and your current folder is your Home folder.
Type in ‘cd .Trash’ (again, without the quotes) and hit Enter. Now your sitting in your trash can. What a mess, eh?
Now we need to look for the file that’s “stuck”. In the Dock, right-click (or ctrl-click) the Trash icon and click on ‘Empty Trash’ in the menu. If a dialog asks you if you want to proceed with emptying the Trash, click ‘Empty Trash’. Now the dialog that’s telling you which file is stuck should show up. Don’t click any button in it yet!
Switch back to Terminal again and type ‘lsof ./’ (that’s lsof followed by a dot and a slash, without the quotes) followed by the file name that you see in the dialog mentioned in step 4. Then hit Enter.
The command might take a couple of seconds to come back with a result, but it should then list out which applications are accessing the stuck file. You can now quit these applications and empty the trash once more (after dismissing the dialog that’s still open from step 4).
Hope that helps
