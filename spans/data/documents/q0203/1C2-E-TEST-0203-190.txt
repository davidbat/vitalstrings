Joined: March 4th, 2006, 8:55 pm
Posted May 7th, 2011, 8:35 am
Ever since version 4.0 final and continuing to 4.0.1 I have noticed that sometimes if FF4 terminates unexpectedly for whatever reason, such as the process having an exception or the power going out, FF will start and run normally, but for the duration of the use, even if idling, it will use up around 5-20% CPU and spin the drive like crazy. When shutting down FF, the process will linger and never close, continuing its odd activity until it is terminated via task manager.
In 4.0 I was able to start in safemode, clear cache, and restart it normally in order to fix it. In 4.0.1 I am no longer able to do that. I spent about an hour trying to figure out what the heck was wrong with it, checked reset window settings, deleted cache and cookies, disabled antivirus and comodo's defense+, disabled all addons and extensions and I just could not get it to stop hanging on shutdown. Eventually I got mad as I noticed FF believes it is doing "something important" since it's spinning the harddrive so much so I got Process Monitor and filtered for "firefox.exe" events.
I found that Firefox was madly reading the c:\users\<username>\appdata\local\mozilla\firefox\profiles\<profilename>\cache.trash folder and everything inside it. I killed the process, deleted the folder and FINALLY firefox started behaving normally! What in the world is the purpose of that folder, why isn't it being deleted when I selected delete cache and cookies so many times, and why is it that unexpected terminations of FF corrupt that cache in a way that results in infinite loops like these? Isn't FF already mature enough to handle these kinds of situations properly? FF 3.6.x never exhibited such an issue.
The OS is Windows 7 64bit SP1 with all updates installed. I have also seen this happen on my laptop which has 32bit Win7. Also I noticed that on the very first startup after an unexpected crash, FF will just freeze up upon being relaunched, displaying the UI and a blank tab and nothing after, and requiring forceful termination. AFTER that, the caching madness starts. Might be of use to whoever knows how FF works. Cache.trash was about 226MB and had around 3000 files. I don't know wether or not that is normal size, but since I selected clear cache so many times, and FF's settings page was then reporting cache sizes of either 0 or a few hundred KB, I assume there was much of the cache left in cache.trash, 226MB can't just be profile data and settings.
Do you like fire? I'm full of it.
dfoulkes
